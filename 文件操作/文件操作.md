# 文件操作

### 读文件(3种方式)

```go
package main

import (
	"bufio"
	"fmt"
	"io"
	"io/ioutil"
	"os"
)

//第一种方式：使用os包，按照固定长度读取文件内容
func read2file1() {
	fileObj, err := os.Open("./main.go")
	if err != nil {
		fmt.Printf("open file faild, err:%v\n", err)
		return
	}
	//关闭文件
	defer fileObj.Close()
	//读文件
	// var tmp = make([]byte, 128) //指定读的长度
	var tmp [128]byte
	for {
		n, err := fileObj.Read(tmp[:])
		if err == io.EOF {
			fmt.Println("读完了")
			return
		}
		if err != nil {
			fmt.Printf("read from file failed, err:%v\n", err)
			return
		}
		fmt.Printf("读了%d个字节\n", n)
		fmt.Println(string(tmp[:n]))
		if n < 128 {
			return
		}
	}
}

//利用bufio这个包读取文件
func read2filebybufio() {
	fileObj, err := os.Open("./main.go")
	if err != nil {
		fmt.Printf("open file faild, err:%v\n", err)
		return
	}
	//关闭文件
	defer fileObj.Close()
	reader := bufio.NewReader(fileObj)
	for {
		line, err := reader.ReadString('\n') //按照字符’\n‘来分割每次读取长度
		if err == io.EOF {
			fmt.Println("读完了")
			return
		}
		if err != nil {
			fmt.Printf("read from file failed, err:%v\n", err)
			return
		}
		fmt.Print(line)
	}
}

// 第三种 使用ioutil包读取文件
func read2FileByIoutil() {
	ret, err := ioutil.ReadFile("./main.go")
	if err != nil {
		fmt.Printf("read from file failed, err:%v\n", err)
		return
	}
	fmt.Println(string(ret))

}
func main() {
	// read2file1()
	// read2filebybufio()
	read2FileByIoutil()
}

```

### 写文件(3种方式)

```GO
package main
import (
	"bufio"
	"fmt"
	"io/ioutil"
	"os"
)
//文件中写入数据，使用os包
func writeDome1() {
	fileObj, err := os.OpenFile("./xx.txt", os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0644)
	if err != nil {
		fmt.Printf("open file failed, err:%v", err)
		return
	}
	//write
	fileObj.Write([]byte("使用os模块写入数据，使用[]byte转换为byte类型的切片!\n"))
	//writeString
	fileObj.WriteString("使用os模块按照string类型写入！")
	fileObj.Close() //关闭文件
}

// 使用bufio包写入数据
func writeDome2() {
	fileObj, err := os.OpenFile("./xx.txt", os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0644)
	if err != nil {
		fmt.Printf("open file failed, err:%v", err)
		return
	}
	defer fileObj.Close()
	//创建一个写的对象
	wr := bufio.NewWriter(fileObj)
	wr.WriteString("使用bufio模块按照string类型写入！")
	wr.Flush()
}

//使用ioutil写入数据
func writeDome3() {
	str := "hello 沙河"
	err := ioutil.WriteFile("./xx.txt", []byte(str), 0666)
	if err != nil {
		fmt.Println("write file failed, err:", err)
		return
	}

}

func main() {
	writeDome1()
	writeDome2()
	writeDome3()
}
```



